# test_3 
# Answer: OK
# Description: test with several vertex templates. Testing auto name generation for
# vertices made with vertex templates

<graph>

	version = 1.0

	<header>
		@
			some code here
		@
	</header>

	<root>
		root = "root"
	</root>

	<tail>
		@
			some code here
		@
	</tail>
	
	main_subgraph = "sub_1"

	<subgraph>
		name = "sub_1"

		condition = @ some code here @

		<vertex>
			name = "sub_1_vert_1"
			
			<code>
				@
					some code here
				@
			</code>
			
			<exchange>	
				name = "ex_1"
				send = "cont_1"
				
			</exchange>
		</vertex>

		<vertex>
			name = "sub_1_vert_2"
			template = "vert_temp_1"
		</vertex>

		<vertex>
			name = "sub_1_vert_3"
			template = "vert_temp_1"
		</vertex>

		<vertex>
			name = "sub_1_vert_4"
			template = "vert_temp_1"
		</vertex>

		<control_edge>
			name = "cont_1"
			template = "edge_template_1"
			send = ("sub_1_vert_1", "ex_1")	
		</control_edge>

		<internal_edge>
			name = "int_1"
			template = "edge_template"
			send= ("vert_temp_1", "ex_1")
			recv = ("sub_1_vert_1", "ex_1")
		</internal_edge>

	</subgraph>

	<subgraph>
		name = "sub_2"
		condition = @ some code here @

		<vertex>
			name = "sub_2_vert_1"
			template = "vert_temp_1"
		</vertex>

		<vertex>
			name = "sub_2_vert_2"
			template = "vert_temp_2"
		</vertex>

		<vertex>
			name = "sub_2_vert_3"
			template = "vert_temp_2"
		</vertex>

		<vertex>
			name = "sub_2_vert_4"
			
			<exchange>
				name = "ex_1"
				recv = "int_1"
				recv = "int_2"
			</exchange>
		</vertex>

		<internal_edge>
			name = "int_1"
			template = "edge_template"
			send= ("vert_temp_1", "ex_1")
			recv = ("sub_2_vert_4", "ex_1")
		</internal_edge>

		<internal_edge>
			name = "int_2"
			template = "edge_template"
			send= ("vert_temp_2", "ex_1")
			recv = ("sub_2_vert_4", "ex_1")
		</internal_edge>



	</subgraph>

	<edge_template>
	    name="edge_template"
		 <send>   
		    <fragment>
		        variable = @ some code here @
		        type     = @ some code here @
		        left     = @ some code here @
		        right    = @ some code here @
		    </fragment>
		 </send>
	
		 <recv>
		    <fragment>
		        variable = @ some code here @
		        type     = @ some code here @
		        left     = @ some code here @
		        right    = @ some code here @
		    </fragment>
		 </recv>
	</edge_template>

	<external_edge>
		name = "ext_1"
		template = "edge_template"
		send = ("sub_1", "vert_temp_1", "ex_1")
		recv = ("sub_2", "vert_temp_2", "ex_1")
	</external_edge>

	<vertex_template>
		name = "vert_temp_1"
	
		<exchange>
			name = "ex_1"
			send = "int_1"
			send = "ext_1"
		</exchange>
	</vertex_template>

	<vertex_template>
		name = "vert_temp_2"

		<code>
			@
				some code here
			@
		</code>

		<exchange>
			name = "ex_1"
			
			send = "int_2"
			recv = "ext_1"
		</exchange>
	</vertex_template>

</graph>

